<!doctype html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>Configuration Â· NoBrainer</title>
  <link rel="stylesheet" href="/css/screen.css" />
</head>

<body class="wrap">
  <header>
  <div class="grid">
    <div class="unit one-fifth"> </div>
    <div class="unit four-fifths">
      <h1> <a href="/"> <span>NoBrainer</span> </a> </h1>
      <h3>A Ruby ORM for RethinkDB</h3>
    </div>
  </div>

<!-- put back when we do it properly for mobiles -->
<!-- <a href="https://github.com/nviennot/nobrainer"><img style="position: absolute; top: 0; right:0; border: 0; width: 149px; height: 149px;" src="/img/forkme.png" alt="Fork me on GitHub"></a> -->

</header>


  <section class="docs">
  <div class="grid">

    <div class="unit one-fifth">
  <aside>
    <h4>Getting Started</h4>
    

<ul>

  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/introduction/">Introduction</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/differences_from_other_orms/">Differences from other ORMs</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class="current"><a href="/docs/configuration/">Configuration</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
</ul>

    <h4>Models</h4> 

<ul>

  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/models/">Models</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/fields/">Fields</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/types/">Types</a></li>
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/timestamps/">Timestamps</a></li>
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/serialization/">Serialization</a></li>
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/persistence/">Persistence</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/callbacks/">Callbacks</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/validations/">Validations</a></li>
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/dirty_tracking/">Dirty Tracking</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
      <li class=""><a href="/docs/associations/">Associations</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/querying/">Querying</a></li>
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/scopes/">Scopes</a></li>
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/eager_loading/">Eager Loading</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
</ul>

    <h4>Advanced Topics</h4>
    

<ul>

  

  
    
  

  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/caching/">Caching</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/rql_layer/">RQL Layer</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/atomic_ops/">Atomic Operations</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/distributed_locks/">Distributed Locks</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/indexes/">Indexes</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/management/">Management</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/multi_tenancy/">Multi Tenancy</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
</ul>

    <h4>Miscellaneous</h4>
    

<ul>

  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/roadmap/">Roadmap</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/changelog/">Changelog</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
      <li class=""><a href="/docs/3rd_party_integration/">3rd-party Integration</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/communication/">Communication</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/faq/">FAQ</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  
    
  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/docs/credits/">Credits</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
</ul>

  </aside>
</div>


    <div class="like-buttons">
      <div class="github">
        <iframe src="/github-btn.html?user=nviennot&repo=nobrainer&type=watch&count=true"
          allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>
      </div>

      <div class="twitter">
        <a href="https://twitter.com/nviennot" class="twitter-follow-button" data-show-count="false" data-lang="en">Follow @nviennot</a>
       <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
      </div>

    </div>

    <div class="unit four-fifths">
      <article>
        <h1>Configuration</h1>
        
<p>NoBrainer can be configured by calling <code>NoBrainer.configure { }</code>.<br />With a Rails application, you may place this configuration block in an initializer, such as <code>config/initializers/nobrainer.rb</code>. The settings are shown with their default values:</p>
<div class='highlight'><pre><code class='ruby'><span class='no'>NoBrainer</span><span class='o'>.</span><span class='n'>configure</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>config</span><span class='o'>|</span>
  <span class='c1'># app_name is the name of your application in lowercase.</span>
  <span class='c1'># When using Rails, the application name is automatically inferred.</span>
  <span class='c1'># config.app_name = config.default_app_name</span>

  <span class='c1'># environment defaults to Rails.env for Rails apps or to the environment</span>
  <span class='c1'># variables RUBY_ENV, RAILS_ENV, RACK_ENV, or :production.</span>
  <span class='c1'># config.environment = config.default_environment</span>

  <span class='c1'># The rethinkdb_url specifies the RethinkDB database connection url.</span>
  <span class='c1'># When left unspecified, NoBrainer picks a database connection by default.</span>
  <span class='c1'># The default is to use localhost, with a database name matching the</span>
  <span class='c1'># application name and the environment.</span>
  <span class='c1'># NoBrainer also reads environment variables when defined:</span>
  <span class='c1'># * RETHINKDB_URL, RDB_URL</span>
  <span class='c1'># * RETHINKDB_HOST, RETHINKDB_PORT, RETHINKDB_DB, RETHINKDB_AUTH</span>
  <span class='c1'># * RDB_HOST, RDB_PORT, RDB_DB, RDB_AUTH</span>
  <span class='c1'># config.rethinkdb_url = config.default_rethinkdb_url</span>

  <span class='c1'># NoBrainer uses logger to emit debugging information.</span>
  <span class='c1'># The default logger is the Rails logger if run with Rails,</span>
  <span class='c1'># otherwise Logger.new(STDERR) with a WARN level.</span>
  <span class='c1'># If the logger is configured with a DEBUG level,</span>
  <span class='c1'># then each database query is emitted.</span>
  <span class='c1'># config.logger = config.default_logger</span>

  <span class='c1'># NoBrainer will colorize the queries if colorize_logger is true.</span>
  <span class='c1'># Specifically, NoBrainer will colorize management RQL queries in yellow,</span>
  <span class='c1'># write queries in red and read queries in green.</span>
  <span class='c1'># config.colorize_logger = true</span>

  <span class='c1'># You probably do not want to use both NoBrainer and ActiveRecord in your</span>
  <span class='c1'># application. NoBrainer will emit a warning if you do so.</span>
  <span class='c1'># You can turn off the warning if you want to use both.</span>
  <span class='c1'># config.warn_on_active_record = true</span>

  <span class='c1'># When the network connection is lost, NoBrainer can retry running a given</span>
  <span class='c1'># query a few times before giving up. Note that this can be a problem with</span>
  <span class='c1'># non idempotent write queries such as increments.</span>
  <span class='c1'># Setting it to 0 disable retries during reconnections.</span>
  <span class='c1'># The default is 1 for development or test environment, otherwise 15.</span>
  <span class='c1'># config.max_retries_on_connection_failure = \</span>
  <span class='c1'>#   config.default_max_retries_on_connection_failure</span>

  <span class='c1'># Configures the durability for database writes.</span>
  <span class='c1'># The default is :soft for development or test environment, otherwise :hard.</span>
  <span class='c1'># config.durability = config.default_durability</span>

  <span class='c1'># Persisted Strings have a configurable maximum length. To get rid of the</span>
  <span class='c1'># length validation, you may use the Text type instead.</span>
  <span class='c1'># config.max_string_length = 255</span>

  <span class='c1'># user_timezone can be configured with :utc, :local, or :unchanged.</span>
  <span class='c1'># When reading an attribute from a model which type is Time, the timezone</span>
  <span class='c1'># of that time is translated according to this setting.</span>
  <span class='c1'># config.user_timezone = :local</span>

  <span class='c1'># db_timezone can be configured with :utc, :local, or :unchanged.</span>
  <span class='c1'># When writting to the database, the timezone of Time attributes are</span>
  <span class='c1'># translated according to this setting.</span>
  <span class='c1'># config.db_timezone = :utc</span>

  <span class='c1'># Default options used when compiling geo queries.</span>
  <span class='c1'># config.geo_options =&gt; { :geo_system =&gt; &#39;WGS84&#39;, :unit =&gt; &#39;m&#39; }</span>

  <span class='c1'># Configures which mechanism to use in order to perform non-racy uniqueness</span>
  <span class='c1'># validations. More about this behavior in the Distributed Locks section.</span>
  <span class='c1'># config.distributed_lock_class = NoBrainer::Lock</span>

  <span class='c1'># Configures the default timing lock options.</span>
  <span class='c1'># config.lock_options = { :expire =&gt; 60, :timeout =&gt; 10 }</span>

  <span class='c1'># Instead of using a single connection to the database, You can tell</span>
  <span class='c1'># NoBrainer to spin up a new connection for each thread. This is</span>
  <span class='c1'># useful for multi-threading usage such as Sidekiq.</span>
  <span class='c1'># Call NoBrainer.disconnect before a thread exits, otherwise you will have</span>
  <span class='c1'># a resource leak, and you will run out of connections.</span>
  <span class='c1'># Note that this is solution is temporary, until we get a connection pool.</span>
  <span class='c1'># config.per_thread_connection = false</span>

  <span class='c1'># The machine id is used to generate primary keys. The default one is seeded</span>
  <span class='c1'># with the machine IP with Socket.gethostname.</span>
  <span class='c1'># The env variable MACHINE_ID can also be used to set the machine id.</span>
  <span class='c1'># When using distinct machine_id, then primary keys are guaranteed to be</span>
  <span class='c1'># generated without conflicts.</span>
  <span class='c1'># config.machine_id = config.default_machine_id</span>

  <span class='c1'># Criteria cache elements. For example, the result of a has_many association</span>
  <span class='c1'># is cached. The per criteria cache is disabled if it grows too big to avoid</span>
  <span class='c1'># out of memory issues.</span>
  <span class='c1'># config.criteria_cache_max_entries = 10_000</span>
<span class='k'>end</span>
</code></pre></div>
<h2 id="removing_activerecord_with_rails">Removing ActiveRecord with Rails</h2>

<p>NoBrainer can coexist with ActiveRecord at runtime. However, It is best to remove ActiveRecord unless you plan to use both SQL and RethinkDB in your application.</p>

<h3 id="with_a_fresh_rails_app">With a fresh Rails app</h3>

<p>If your Rails application is not yet created, you can create your rails app with:</p>
<div class='highlight'><pre><code class='bash'>rails new app_name --skip-active-record
</code></pre></div>
<h3 id="with_an_existing_rails_app">With an existing Rails app</h3>

<p>To remove ActiveRecord from an existing Rails application, three steps must be done:</p>

<p>1) Open <code>config/application.rb</code>. On line 3, replace <code>require &#39;rails/all&#39;</code> with:</p>
<div class='highlight'><pre><code class='ruby'><span class='c1'># require &#39;active_record/railtie&#39;</span>
<span class='nb'>require</span> <span class='s1'>&#39;action_controller/railtie&#39;</span>
<span class='nb'>require</span> <span class='s1'>&#39;action_view/railtie&#39;</span>
<span class='nb'>require</span> <span class='s1'>&#39;action_mailer/railtie&#39;</span>
<span class='nb'>require</span> <span class='s1'>&#39;active_job/railtie&#39;</span>
<span class='nb'>require</span> <span class='s1'>&#39;rails/test_unit/railtie&#39;</span>
<span class='nb'>require</span> <span class='s1'>&#39;sprockets/railtie&#39;</span>
</code></pre></div>
<p>2) Comment all the configuration options in <code>config/environments/*.rb</code> that contains <code>active_record</code>.</p>

<p>3) Remove <code>config/database.yml</code>, and anything in <code>db/</code> except <code>db/seeds.rb</code>.</p>

<h2 id="activerecord_with_nobrainer">ActiveRecord with NoBrainer</h2>

<p>If ActiveRecord is present with NoBrainer there will be a conflict with the built in rake tasks and Rails generators. To get around this, prefix the <code>active_record</code> namespace before the generator name:</p>
<div class='highlight'><pre><code class='bash'>rails g active_record:migration migration_name
</code></pre></div>
        <hr />
        <div class="section-nav">
  <div class="left align-right">
    
      <a href="/docs/differences_from_other_orms/" class="prev">
        Back
      </a>
    
  </div>
  <div class="right align-left">
    
      <a href="/docs/models/" class="next">
        Next
      </a>
    
  </div>
  <div class="clear"></div>
</div>

      </article>
    </div>

    <div class="clear"></div>

  </div>
</section>


  <footer>
  <div class="grid">
    <div class="unit whole">
      NoBrainer is written and maintained by
      <a href="https://twitter.com/nviennot">Nicolas Viennot</a>.
    </div>
  </div>
</footer>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46753546-1', 'nobrainer.io');
  ga('send', 'pageview');
</script>

</body>
</html>
